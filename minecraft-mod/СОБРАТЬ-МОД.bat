@echo off
chcp 65001 >nul
title Сборка мода Axmed555 Visuals

echo.
echo ╔═══════════════════════════════════════════════════════╗
echo ║       СБОРКА МОДА AXMED555 VISUALS                    ║
echo ╚═══════════════════════════════════════════════════════╝
echo.
echo Нажмите любую клавишу чтобы начать проверку...
pause >nul
echo.

echo ═══════════════════════════════════════════════════════
echo ШАГ 1: Проверка текущей папки
echo ═══════════════════════════════════════════════════════
echo Текущая папка: %CD%
echo.

if not exist "gradlew.bat" (
    echo ❌ ОШИБКА: Файл gradlew.bat не найден!
    echo.
    echo Вы запустили файл из НЕПРАВИЛЬНОЙ папки!
    echo.
    echo ПРАВИЛЬНО: Откройте папку minecraft-mod и запустите оттуда
    echo.
    pause
    exit /b 1
)

echo ✅ Файл gradlew.bat найден
echo.

echo ═══════════════════════════════════════════════════════
echo ШАГ 2: Проверка Java
echo ═══════════════════════════════════════════════════════

where java >nul 2>&1
if errorlevel 1 (
    echo ❌ ОШИБКА: Java не найдена в системе!
    echo.
    echo Возможные причины:
    echo   1. Java не установлена
    echo   2. Нужна ПЕРЕЗАГРУЗКА компьютера после установки
    echo.
    echo Что делать:
    echo   1. Установите Java 8:
    echo      https://adoptium.net/temurin/releases/?version=8
    echo   2. ПЕРЕЗАГРУЗИТЕ компьютер!
    echo   3. Запустите этот файл снова
    echo.
    pause
    exit /b 1
)

echo Java найдена:
java -version 2>&1
echo.

echo ═══════════════════════════════════════════════════════
echo ШАГ 3: Запуск сборки мода
echo ═══════════════════════════════════════════════════════
echo.
echo ⏱️  Это займёт 10-15 минут при первой сборке!
echo.
echo Gradle будет скачивать:
echo   - Minecraft 1.16.5
echo   - Forge библиотеки
echo   - Зависимости
echo.
echo НЕ ЗАКРЫВАЙТЕ ЭТО ОКНО!
echo.
echo Нажмите любую клавишу чтобы начать сборку...
pause >nul
echo.
echo Начинаю сборку...
echo.

gradlew.bat clean build --warning-mode all

if errorlevel 1 (
    echo.
    echo ═══════════════════════════════════════════════════════
    echo ❌ СБОРКА ЗАВЕРШИЛАСЬ С ОШИБКОЙ!
    echo ═══════════════════════════════════════════════════════
    echo.
    echo Что могло пойти не так:
    echo   - Нет интернета (Gradle скачивает файлы)
    echo   - Блокировка антивирусом
    echo   - Недостаточно места на диске
    echo.
    echo Попробуйте запустить снова или покажите эти ошибки
    echo.
    pause
    exit /b 1
)

echo.
echo ═══════════════════════════════════════════════════════
echo ✅ СБОРКА УСПЕШНА!
echo ═══════════════════════════════════════════════════════
echo.
echo 🎮 Готовый мод находится в:
echo    %CD%\build\libs\axmed555-visuals-1.0.0.jar
echo.
echo 📁 Что делать дальше:
echo    1. Откройте папку build\libs\
echo    2. Скопируйте файл axmed555-visuals-1.0.0.jar
echo    3. Вставьте в .minecraft\mods\
echo    4. Запустите Minecraft через Forge 1.16.5
echo.
echo 🎯 В игре нажмите ПРАВЫЙ SHIFT - откроется меню мода!
echo.
pause
